<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ù…Ø±Ø´Ø¯ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„Ø°ÙƒÙŠ</title>
  <style>
    :root { --bg:#0f172a; --card:#111827; --muted:#94a3b8; --ink:#e5e7eb; --brand:#22c55e; --brand-ink:#052e16; }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,Arial,"Apple Color Emoji","Segoe UI Emoji";background:var(--bg);color:var(--ink);}
    .wrap{max-width:1000px;margin:32px auto;padding:16px}
    .card{background:var(--card);border:1px solid #1f2937;border-radius:18px;padding:20px 18px;box-shadow:0 10px 30px rgba(0,0,0,.25)}
    h1{margin:0 0 8px;font-size:28px}
    p.lead{margin:0 0 18px;color:var(--muted)}
    .row{display:flex;gap:10px;flex-wrap:wrap}
    .row > *{flex:1 1 240px}
    input,select,button{width:100%;padding:12px 14px;border-radius:12px;border:1px solid #334155;background:#0b1220;color:var(--ink);outline:none}
    input::placeholder{color:#93a1b1}
    button{cursor:pointer;background:linear-gradient(135deg,#16a34a,#22c55e);border:none;color:#04210f;font-weight:700}
    button:disabled{opacity:.6;cursor:not-allowed}
    .results{margin-top:18px;display:grid;grid-template-columns:1fr;gap:12px}
    .item{background:#0b1220;border:1px solid #1f2937;border-radius:16px;padding:14px}
    .meta{display:flex;gap:10px;flex-wrap:wrap;color:#9ca3af;font-size:13px}
    .ayah{font-size:20px;line-height:1.9;margin:8px 0;word-spacing:3px}
    .actions{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
    .tag{background:#0b1628;border:1px solid #1f2937;color:#cbd5e1;border-radius:999px;padding:4px 10px;font-size:12px}
    .empty, .error{padding:18px;border:1px dashed #334155;border-radius:14px;color:#aab4c2;text-align:center}
    details{background:#0a1020;border:1px solid #1e293b;border-radius:12px;padding:10px 12px;margin-top:10px}
    summary{cursor:pointer;color:#a7f3d0;font-weight:700}
    .foot{margin-top:18px;color:#93a1b1;font-size:13px;text-align:center}
    .small{font-size:12px;color:#9fb0c0}
    .loading{animation:pulse 1.2s ease-in-out infinite}
    @keyframes pulse{0%{opacity:0.5}50%{opacity:1}100%{opacity:0.5}}
    .counter{font-variant-numeric:tabular-nums;color:#a7f3d0}
    .hl{background:#052e16;color:#a7f3d0;padding:2px 6px;border-radius:6px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div style="display:flex;align-items:center;gap:12px;flex-wrap:wrap">
        <a href="https://www.EsmartMarketPro.com" target="_blank" rel="noopener" style="display:flex;align-items:center;gap:8px;text-decoration:none">
          <img src="https://www.EsmartMarketPro.com/logo.png" alt="E-Smart Market Pro" onerror="this.style.display='none'" style="border-radius:8px;border:1px solid #1f2937;background:#fff;width:50px;height:50px;object-fit:contain">
          <span style="color:#a7f3d0;font-weight:bold">E-Smart Market Pro</span>
        </a>
        <h1 style="margin:0">Ù…Ø±Ø´Ø¯ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„Ø°ÙƒÙŠ</h1>
        <div style="margin-left:auto">
          <select id="pageLang">
            <option value="">ğŸŒ Ù„ØºØ© Ø§Ù„ØµÙØ­Ø©</option>
            <option value="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
            <option value="en">English</option>
            <option value="fr">FranÃ§ais</option>
            <option value="es">EspaÃ±ol</option>
          </select>
        </div>
      </div>
      <p class="lead">Ø§Ø¨Ø­Ø« Ø¨ÙƒÙ„Ù…Ø© Ø£Ùˆ Ù…ÙˆØ¶ÙˆØ¹ Ù„ÙŠØªÙ… Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„Ø¢ÙŠØ§Øª Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© Ù…Ø¹ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø³ÙˆØ±Ø© ÙˆØ±Ù‚Ù… Ø§Ù„Ø¢ÙŠØ© ÙˆØ±ÙˆØ§Ø¨Ø· Ù…Ø¨Ø§Ø´Ø±Ø© Ù„Ù„ØªÙØ§Ø³ÙŠØ± Ø§Ù„Ù…ÙˆØ«ÙˆÙ‚Ø©.</p>

      <div class="row" style="margin-bottom:10px">
        <input id="q" placeholder="Ø§ÙƒØªØ¨ ÙƒÙ„Ù…Ø© Ø£Ùˆ Ù…ÙˆØ¶ÙˆØ¹ (Ù…Ø«Ù„: Ø§Ù„Ø¹Ø¯Ù„ØŒ Ø§Ù„ØµØ¨Ø±ØŒ Ø§Ù„Ø±Ø¨Ø§â€¦)" />
        <select id="limit">
          <option value="5">Ø£Ø¸Ù‡Ø± 5</option>
          <option value="10" selected>Ø£Ø¸Ù‡Ø± 10</option>
          <option value="20">Ø£Ø¸Ù‡Ø± 20</option>
          <option value="50">Ø£Ø¸Ù‡Ø± 50</option>
        </select>
        <button id="go">Ø¨Ø­Ø« Ø¨Ø§Ù„Ù‚Ø±Ø¢Ù†</button>
      </div>

      <div class="small">Ø§Ù„Ù…ØµØ¯Ø± Ø§Ù„Ù†ØµÙŠ: <span class="hl">api.alquran.cloud</span> â€” Ø§Ù„ØªÙØ§Ø³ÙŠØ± Ø¹Ø¨Ø± Ø±ÙˆØ§Ø¨Ø· Ù…Ø¨Ø§Ø´Ø±Ø© Ø¥Ù„Ù‰ <span class="hl">quran.com</span> Ù„ØªÙØ§Ø¯ÙŠ Ù…Ø´Ø§ÙƒÙ„ CORS.</div>

      <div id="status" class="small" style="margin-top:8px"></div>

      <div id="results" class="results"></div>

      <div class="foot">âš ï¸ Ù…Ù„Ø§Ø­Ø¸Ø©: ÙÙŠ Ø­Ø§Ù„ Ù„Ù… ØªØ¸Ù‡Ø± Ø§Ù„ØªÙØ§Ø³ÙŠØ± Ø¯Ø§Ø®Ù„ Ø§Ù„ØµÙØ­Ø©ØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø© Ù„ÙƒÙ„ Ø¢ÙŠØ© Ù„Ù„Ø§Ø·Ù„Ø§Ø¹ Ø¹Ù„Ù‰ Ø§Ù„ØªÙØ³ÙŠØ± ÙÙŠ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù‚Ø±Ø¢Ù†.ÙƒÙˆÙ….</div>
    </div>
  </div>

<script>
const qEl = document.getElementById('q');
const limitEl = document.getElementById('limit');
const goEl = document.getElementById('go');
const resultsEl = document.getElementById('results');
const statusEl = document.getElementById('status');

function setStatus(msg, kind='info'){
  statusEl.textContent = msg || '';
  statusEl.className = 'small ' + (kind === 'loading' ? 'loading' : '');
}

function escapeHtml(s){
  return s.replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
}

function buildTafsirLinks(surahNumber, ayahNumber){
  const vk = `${surahNumber}:${ayahNumber}`;
  const base = `https://quran.com/${surahNumber}/${ayahNumber}?translations=131&tafsirs=ar-tafsir-alsadi,ar-tafsir-ibn-kathir,ar-tafsir-al-tabari`;
  return `
    <div class="actions">
      <a class="tag" target="_blank" rel="noopener" href="${base}">ÙØªØ­ Ø§Ù„ØªÙØ³ÙŠØ± Ø§Ù„Ù…ÙˆØ«ÙˆÙ‚ (quran.com)</a>
      <span class="tag">Ù…ÙØªØ§Ø­ Ø§Ù„Ø¢ÙŠØ©: ${vk}</span>
    </div>
  `;
}

async function searchQuran(query, limit=10){
  const url = `https://api.alquran.cloud/v1/search/${encodeURIComponent(query)}/all/ar`;
  const r = await fetch(url);
  if(!r.ok) throw new Error('ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù…ØµØ¯Ø± Ø§Ù„Ù‚Ø±Ø¢Ù†');
  const data = await r.json();
  return data?.data?.matches || [];
}

function renderMatches(matches, limit){
  resultsEl.innerHTML = '';
  if (!matches.length){
    resultsEl.innerHTML = `<div class="empty">Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¢ÙŠØ§Øª Ù…Ø·Ø§Ø¨Ù‚Ø©. Ø¬Ø±Ø¨ ÙƒÙ„Ù…Ø© Ù‚Ø±ÙŠØ¨Ø© Ø£Ùˆ Ù…Ø±Ø§Ø¯ÙÙ‹Ø§.</div>`;
    return;
  }
  const slice = matches.slice(0, limit);
  slice.forEach((m, i) => {
    const ayahText = escapeHtml(m.text || '');
    const surahNum = m?.surah?.number;
    const surahName = m?.surah?.name || m?.surah?.englishName || 'Ø³ÙˆØ±Ø© ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙØ©';
    const ayahNo = m?.numberInSurah;
    const item = document.createElement('div');
    item.className = 'item';
    item.innerHTML = `
      <div class="meta">
        <span class="tag">Ø§Ù„Ù†ØªÙŠØ¬Ø© <span class="counter">${i+1}</span></span>
        <span class="tag">${escapeHtml(surahName)}</span>
        <span class="tag">Ø¢ÙŠØ©: ${ayahNo}</span>
      </div>
      <div class="ayah">ï´¿ ${ayahText} ï´¾</div>
      ${buildTafsirLinks(surahNum, ayahNo)}
      <details>
        <summary>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ØªÙ‚Ù†ÙŠØ©</summary>
        <div class="small">Surah: ${surahNum} â€” Ayah: ${ayahNo} â€” Global #: ${m.number}</div>
      </details>
    `;
    resultsEl.appendChild(item);
  });
}

async function handleSearch(){
  const query = (qEl.value || '').trim();
  if(!query){ qEl.focus(); return; }
  goEl.disabled = true;
  setStatus('Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…ØµØ­Ù Ø§Ù„Ø´Ø±ÙŠÙâ€¦', 'loading');
  try{
    const matches = await searchQuran(query, +limitEl.value);
    renderMatches(matches, +limitEl.value);
    if(matches.length){
      setStatus(`ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ${matches.length} Ø¢ÙŠØ©/Ù…Ø·Ø§Ø¨Ù‚Ø©. Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø©: ${Math.min(matches.length, +limitEl.value)}.`);
    }else{
      setStatus('Ù„Ø§ Ù†ØªØ§Ø¦Ø¬. Ø­Ø§ÙˆÙ„ ÙƒÙ„Ù…Ø§Øª Ø¨Ø¯ÙŠÙ„Ø© Ù…Ø«Ù„: Ø§Ù„ØªÙ‚ÙˆÙ‰ØŒ Ø§Ù„ØµØ¨Ø±ØŒ Ø§Ù„Ù†ÙØ§Ù‚ØŒ Ø§Ù„Ø¨ÙŠØ¹ØŒ Ø§Ù„Ø±Ø¨Ø§â€¦');
    }
  }catch(err){
    console.error(err);
    resultsEl.innerHTML = `<div class="error">Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¨Ø­Ø«. ØªØ£ÙƒØ¯ Ù…Ù† Ø§ØªØµØ§Ù„ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª ÙˆØ­Ø§ÙˆÙ„ Ù„Ø§Ø­Ù‚Ù‹Ø§.</div>`;
    setStatus('ØªØ¹Ø°Ø± Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨.');
  }finally{
    goEl.disabled = false;
  }
}

goEl.addEventListener('click', handleSearch);
qEl.addEventListener('keydown', e => { if(e.key === 'Enter') handleSearch(); });

// ØªÙ„Ù…ÙŠØ­ Ø£ÙˆÙ„ÙŠ
qEl.value = 'Ø§Ù„Ø¹Ø¯Ù„';
</script>

<div id="google_translate_element" style="display:none"></div>
<script type="text/javascript">
function googleTranslateElementInit() {
  new google.translate.TranslateElement({pageLanguage: 'ar', includedLanguages: 'ar,en,fr,es', layout: google.translate.TranslateElement.InlineLayout.SIMPLE}, 'google_translate_element');
}
document.getElementById('pageLang').addEventListener('change', function(){
  var lang = this.value;
  if(lang){
    var gtFrame = document.querySelector('iframe.goog-te-menu-frame');
    if(!gtFrame){
      alert('Ø¬Ø§Ø±Ù ØªÙØ¹ÙŠÙ„ Ø£Ø¯Ø§Ø© Ø§Ù„ØªØ±Ø¬Ù…Ø©ØŒ Ø­Ø§ÙˆÙ„ Ø¨Ø¹Ø¯ Ø«ÙˆØ§Ù†Ù.');
      return;
    }
    var innerDoc = gtFrame.contentDocument || gtFrame.contentWindow.document;
    var langLink = innerDoc.querySelector('a[lang="'+lang+'"]');
    if(langLink){ langLink.click(); }
  }
});
</script>
<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

</body>
</html>